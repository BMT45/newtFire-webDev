<!DOCTYPE html
  SYSTEM "about:legacy-compat">
<html xmlns="http://www.w3.org/1999/xhtml">
    
    
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <link rel="stylesheet" type="text/css" href="explain.css" />
        <title>SVG Exercise 3</title>
    </head>

    <body>
        <!--#include virtual="top.html" -->
        <h1><span class="banner">SVG Exercise 3</span></h1>
    <h3>Overview</h3>
    <p>In XSLT Exercise 3, you constructed an HTML table from survey data originally printed in a nineteenth-century table of interest to the Nell Nelson Project: </p>
    <img src="originalWSGAch1_table.jpg"/>
        The Nelson team has encoded a version of this table in TEI markup called <dfn>feature structures</dfn> designed for binding related data together, and from which
        we extracted the HTML table data in our XSLT assignment. We now return to this file to plot the data again, writing XSLT to generate SVG in the form of a <dfn>stacked bar graph</dfn>. You may find it helpful to review your work and our solution to XSLT Exercise 3 as you begin this assignment.
        
        <h3>The text</h3>
        <p>The source text can be found here:
            <a href="WSGATableCh1.xml">WSGATableCh1.xml</a> if you misplaced the copy you worked with in XSLT Exercise 3. You should
            right-click on this link, download the file, and open it in &lt;oXygen/&gt;. (We will plan to use this file at least one more time on a JavaScript exercise, so once again, you may wish to keep this file handy.) 
            (As usual, if you are downloading, please do not
            just click to open it in a browser and copy, which can add some browser rendering
            characters that will mess up your code; instead, you need to right click and download the file to save it to your machine.)</p>

        <p>Reviewing the contents of the TEI XML file, notice how the survey data is bound together in elements and attributes. 
            Each <code>&lt;fs&gt;</code> element holds a series of <code>&lt;f&gt;</code> elements which contain a survey question and a series of responses including data in <code>@n</code> attributes on the number of people who responded. Here is a sample of our TEI source coding:</p>
        <pre>
            &lt;fs type="QandA"&gt;
               &lt;f name="question"&gt;
                  &lt;string&gt;Are there facilities for washing?&lt;/string&gt;
               &lt;/f&gt;
              &lt;f name="note"&gt;Fourteen answered yes, but if caught washing are fined.&lt;/f&gt;
               &lt;f name="response" select="Yes" n="460"/&gt;
               &lt;f name="response" select="No" n="124"/&gt;
               &lt;f name="response" select="Blank" n="226"/&gt;
               &lt;f name="response" select="Yes_but_fined" n="14"/&gt;
            &lt;/fs&gt;
        </pre>
        <h3>The task</h3>
        <p>Your goal is to present an effective visual summary of one portion of these survey responses: only the questions that could be answered with a <q>Yes</q> or a <q>No</q> (which includes the one distinctive question that could be answered <q>Yes but fined</q>). You will ultimately produce a stacked bar chart that represents the percentages of people who responded in each way to the twelve questions that involved <q>Yes</q> or <q>No</q> answers, which means that you will need to do some calculations in the XSLT you write. Here is <a href="ebbWSGAOutput.svg">a sample view of output</a> we would like to produce, though your graph does not have to look exactly like ours. We chose to sort our questions by the quantities of people who answered <q>Yes</q>, to present the questions and the survey data in order from those most frequently to least frequently answered with <q>Yes</q>. You may choose to sort your data a different way, such as by the quantity of Blank (missing) or <q>No</q> responses. You may, of course, also decide to scale and color your graph and bars differently than we did, and you will want to decide whether you prefer to use the SVG <code>&lt;rect&gt;</code> element or the SVG <code>&lt;line&gt;</code> element (which is what we used in our solution). While we leave it up to you to decide how you want to scale and color your graph or the fonts you want to use for your text, this assignment has the following requirements:</p>
        <ul>
            <li>Plot only the data from the twelve questions that were answered with <q>Yes</q> or <q>No</q>. (For our purposes, you can ignore the other handful of survey questions that have a different set of responses.)</li>
            <li>Do <em>not</em> plot the raw numbers, since the questions have an uneven total number of respondents (as we discovered when we plotted our HTML tables in XSLT Exercise 3). Instead, <strong>calculate the percentages</strong> of people who responded in a particular way. To calculate the percentage who answered <q>Yes</q> to a particular survey question, you will need to divide the <code>@n</code> of <q>Yes</q> answers by the <code>sum()</code> of all the <code>@n</code> who responded to that particular question and multiply the result by 100 to make a percent value.</li>
            <li>When you plot with percentages and create a stacked bar chart, each kind of response is plotted just on top of the other kinds, and the values stack up to 100. This means your highest plot (and lowest value) for y will be -100, plotting <em>upwards</em> from zero, before you multiply by a factor to scale your y axis values the way you wish).</li>
            <li>Knowing that you are plotting percentages, and you are plotting stacked bars that represent the response to each of a set total of questions that can be answered with a "Yes" (and there should be twelve of these), plot an X and a Y axis that is appropriate to hold all your bar plots, and label your Y axis in some way that demonstrates you are working with percent values. (You may wish to draw a slash at the 50% mark as we did, but that is optional). Use global variables to help you space your bars evenly across the X axis.</li>
            <li>As we mentioned before, you must ultimately create a stacked bar chart. Begin this by plotting just one set of responses, the responses you want to sit at the bottom of your stack, plotting upwards from the X axis. To plot the other rectangles on top of this, you will need to start drawing those from the top of a bar you have just drawn, which you do by <strong>adding</strong> the Y value for the top of the low bar to the height of the next bar that is to sit on top of it.</li>  
            <li>Output the text of each question with its associated bar charts of responses, beneath the X axis. To plot this as we did in our sample output, it will help to study SVG <code>text</code> element formatting, and what attributes are used to control it. (There are a number that you might experiment with to rotate text and change its orientation, but we used the <code>@style="writing-mode: tb;"</code> attribute to make the text run vertically down the page.) Take a look at <a href="http://tutorials.jenkov.com/svg/text-element.html#text">Jakob Jenkov's SVG tutorial</a> for a good resource for learning about the range of attributes you can apply to SVG <code>text</code> and other SVG elements, and the various things they do. We find the <code>@text-anchor</code> attribute especially helpful to anchor the textâ€™s X and Y coordinates either in the start, end, or exact center of the text string.</li>
            <li>Label each of your bars with their percent value, but when you do this, suppress the raw form with the decimal places, and use the <code>round()</code>  or <code>format-number()</code> functions to remove the decimal places, or just use one or two decimal points in the tenths or hundredths. Look up these functions in the Michael Kay book if you have it, or look at w3schools' examples of <a href="http://www.w3schools.com/xsl/func_formatnumber.asp">format-number()</a> and <a href="http://www.w3schools.com/xsl/xsl_functions.asp">round()</a>, which simply takes a decimal number and rounds to the nearest integer. (For purposes of SVG plotting, you can have X or Y coordinates that go out to a large number of decimal places, so the only reason you have to think about rounding is that you may want to display numbers in a way that human readers will expect.)</li>
        </ul>
        
        <h3>What to Submit</h3>
        <p>Turn in your XSLT file. We will generate your SVG output ourselves by running your XSLT. 
            Remember to save and open your SVG output in oXygen and in a web browser to be sure it is valid and that it is rendering as you think it should be. </p>
    </body>
</html>
