<!DOCTYPE html
  SYSTEM "about:legacy-compat">
<html xmlns="http://www.w3.org/1999/xhtml">


    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <link rel="stylesheet" type="text/css" href="explain.css" />
        <title>XSLT Exercise 3 (CDV)</title>
    </head>



    <body>
        <!--#include virtual="topAuthorRJP43.html" -->
        <h1><span class="banner">XSLT Exercise 3</span></h1>
        <p><span class="smaller">This assignment is an edited compilation of <a
                    href="XSLTExercise5.html">XSLT Exercise 5</a> and <a href="XSLTExercise6.html"
                    >XSLT Exercise 6</a> from our <a href="CDASyll.html">Coding and Digital Archives
                    course</a>.</span></p>
        <h3>Preliminaries</h3>
        <h4>Working with a Collection of Files in XSLT</h4>
        <p>For this assignment, you will be working with a digitized XML collection of Emily
            Dickinson's poems and you will need to access this collection in GitHub. Emily Dickinson
            made little bundles of her manuscript poems with a needle and thread, and these have
            come to be known as <dfn>fascicles</dfn> by Dickinson scholars. We have digitally
            reproduced a bundle that Dickinson scholars have named Fascicle 16 by using a folder or
            directory, which holds a digital collection of files together. We can process a whole
            directory of files using the <code>collection()</code> function in XSLT, so we can
            represent content from a whole collection of XML files in one or more output HTML files.
            One useful application for working with a collection is to process several short XML
            files and unify them on a single HTML page designed to merge their content. In this
            case, we will be representing the poems encoded in eleven small XML files inside one
            HTML page, which we will produce with a table of contents giving poems by number and
            first lines, followed by the full text of the poems themselves, formatted in HTML with
            numbered lines. Since these poems are all encoded with the same structural elements, we
            can use the <code>collection()</code> function to reach into them as a group, and output
            their content one by one based on their XML hierarchy. Really, we are treating the
            collection itself as part of the hierarchy as we write our XSLT, so we move from the
            directory down into the document node of each file to do our XSLT processing.</p>
        <h4>The input collection</h4>
        <p>This assignment requires you to use our <strong>DHClass-Hub</strong> so you can work with
            a <dfn>collection</dfn> (a.k.a. <strong>directory of files</strong>) rather than just
            one at a time as we have been doing up to this point. Here is how to access the
            directory:</p>
        <ul>
            <li>Pull any new changes into your local computer from the DHClass-Hub to your computer
                (sync DHClass-Hub), or <a href="https://github.com/ebeshero/DHClass-Hub">clone the
                    repository</a> if it is not already on your computer. (If you have not synced or
                cloned a GitHub repository in a while; please see the <a
                    href="https://github.com/ebeshero/DHClass-Hub#dhclass-hub">instructions posted
                    in our Readme file</a> or review our <a href="explainGitShell.html">Guide to Git
                    Shell</a>). </li>
            <li>When you have synced the repository, open the DHClass-Hub locally on your computer,
                and find in it the <strong>Tutorials-and-Assignments</strong> directory. Inside
                there is a directory named <strong>XSLT</strong>. Within that folder is another
                directory named <strong>Dickinson</strong> that contains eleven XML files that we
                are working with as a collection in this assignment.</li>
            <li><strong>Copy this Dickinson directory (the entire folder) to some other location on
                    your computer</strong> outside of your GitHub directories. (We do not want you
                to push your homework to the whole class over our DHClass-Hub, so we just need you
                to make your own private copy of this directory that can sit in the same place on
                your local computer in which you do your homework for this assignment.</li>
            <li>Do not rename the file folder or the files inside, as you will need to refer to them
                as a coherent collection.</li>
        </ul>
        <p>Please be careful to <strong>copy</strong> rather than move the directory out of GitHub!
            If you move it out of the directory, the next time you sync our DHClass-Hub, GitHub will
            prompt you to commit the change and push it, which will effectively eliminate the
            Dickinson folder. One of us instructors can easily put it back if that happens, but
            please alert us ASAP if something goes awry!</p>
        <h4>Housekeeping with the stylesheet template: From TEI to XHTML</h4>
        <p>Our Emily Dickinson collection is coded in the TEI namespace, which means that your XSLT
            stylesheet must include an instruction at the top to specify that when it tries to match
            elements, it needs to match them in that TEI namespace. When you create an new XSLT
            document in &lt;oXygen/&gt; it won’t contain that instruction by default, so whenever
            you are working with TEI you need to add it (See the text in blue below). To ensure that
            the output would be in the XHTML namespace, we added a default namespace declaration (in
                <span style="color: purple;">purple</span> below). To output the required DOCTYPE
            declaration, we also created <code>&lt;xsl:output&gt;</code> element as the first child
            of our root <code>&lt;xsl:stylesheet&gt;</code> element (in <span style="color:#006400;"
                >green</span> below), and we needed to include an attribute there to omit the
            default XML declaration because if we output it that XML line in our XHTML output, it
            will not produce valid HTML with the w3C and might produce quirky problems with
            rendering in various web browsers. So, our modified stylesheet template and xsl:output
            line is this, and you should copy this into your stylesheet: </p>
        <pre>&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;xsl:stylesheet xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
      xmlns:xs="http://www.w3.org/2001/XMLSchema"
    <span style="color:blue;">xpath-default-namespace="http://www.tei-c.org/ns/1.0"</span>
         xmlns:math="http://www.w3.org/2005/xpath-functions/math"
    exclude-result-prefixes="xs math"
    <span style="color:purple;">xmlns="http://www.w3.org/1999/xhtml"</span>
         version="3.0"&gt;
    
         <span style="color:#006400;">&lt;xsl:output method="xhtml" encoding="utf-8" doctype-system="about:legacy-compat"
        omit-xml-declaration="yes"/&gt;</span>
    
&lt;/xsl:stylesheet&gt;</pre>
        <h4>Using modal XSLT</h4>
        <p>Besides working with a collection of files, the other interesting new application in this
            assignment is <strong>modal XSLT</strong>, which lets you process the same nodes in your
            document in two different ways. How can you output the same element contents to sit as
            list items in a table of contents at the top of an HTML page, <em>and also</em> as
            headers positioned throughout the body of your document, below the table of contents?
            Wouldn’t it be handy to be able to have two completely different template rules that
            match exactly the same elements: one rule to output the data as list items in the table
            of contents, and the other to output the same data as headers? You can write two
            template rules that will match the same nodes (have the same value for their
                <code>@match</code> attribute), but how do you make sure that the correct template
            rule is handling the data in the correct place?</p>
        <p>To permit us to write multiple template rules that process the same input nodes in
            different ways for different purposes, we write <strong>modal XSLT</strong>, and that is
            what you will be learning to write with this assignment. Modal XSLT allows you to output
            the same parts of the input XML document in multiple locations and treat them
            differently each time. That is, it lets you have two different template rules for
            processing the same elements or other nodes in different ways, and you use the
                <code>@mode</code> attribute to control how the elements are processed <em>at a
                particular place</em> in the transformation. Please read the explanation and view
            the examples in <a href="http://dh.obdurodon.org/modal-xslt.html">Obdurodon's tutorial
                on Modal XSLT</a> before proceeding with the assignment, so you can see where and
            how to set the <code>@mode</code> attribute and how it works to control processing.</p>
        <h4>Using attribute value templates (AVTs)</h4>
        <p>For this task you will give each of the poems <code>@id</code> values that are a
            concatenation of the letter <q>p</q> and the distinct identifying number given in the
                <code>idno</code> element in the TEI header of each poem file: example
                <code>&lt;idno&gt;1601&lt;/idno&gt;</code> for Poem 6. The <code>@id</code>
            attributes created get added to the <code>&lt;h2&gt;</code> elements used as titles for
            each poem in the body of the HTML, e.g., <code>&lt;h2 id="p1606"&gt;</code>. Meanwhile,
            in the table of contents at the top you will create <code>&lt;a&gt;</code> elements with
                <code>@href</code> attributes that point to these <code>@id</code> values. Please
            read Obdurodon’s page on <a href="http://dh.obdurodon.org/avt.xhtml">attribute value
                templates (AVT)</a> before proceeding with the assignment.</p>
        <p><em>The value of the <code>@href</code> attribute must begin with a leading <q>#</q>
                character, but that <q>#</q> must not be part of the value of the <code>@id</code>
                attribute to which it points.</em> For example,</p>
        <pre>&lt;li&gt;<code>&lt;a href="#p1606"&gt;</code>&lt;strong&gt;Poem 6 (J 281: 1861/1935)&lt;/strong&gt;<code>&lt;/a&gt;</code>: 
               1: 'Tis so appalling—it exhilarates— &lt;br /&gt; [Variants: 4]&lt;/li&gt;</pre>
        <p>means if the user clicks on the linked content in this list item, the browser will scroll
            to the line that reads <code>&lt;h2 id="p1606"&gt;</code> in the main body of the page.
                <em>Remember: the value of the <code>@href</code> attribute begins with <q>#</q>,
                but the value of the corresponding <code>@id</code> attribute on the
                    <code>&lt;h2&gt;</code> element you want to scroll to doesn’t.</em></p>
        <h3>Overview of the assignment</h3>
        <p>For this assignment you need to produce in one HTML page our collection of Emily
            Dickinson’s eleven poems in Fascicle 16. The page should include the following:</p>
        <ul>
            <li>A main header element titling the page</li>
            <li>A table of contents (using the modal XSLT declaration)</li>
            <li>The table of contents should have one entry for each poem, which produces the
                information we have encoded in <code>&lt;title&gt;</code> element that is a
                descendant of the <code>&lt;body&gt;</code> element in our XML source code, together
                with the first line, and a count of the number of variants we have recorded in each
                poem</li>
            <li>The table of contents should sort the poem titles by the variants from least to
                greatest</li>
            <li><strong>The first bonus task</strong> (the sorting bonus): create a second table of
                contents that sorts the poem titles another way (ie. alphabetical).</li>
            <li>Each poem title in the table of contents shoud use attribute value templates to link
                to the titles of the poems in the body of the HTML</li>
            <li>Below the full table of contents (one line for each poem) you should render the
                complete text of all eleven poems</li>
            <li>The stanzas (<code>&lt;lg&gt;</code>) of each poem should be held and spaced apart
                using HTML <code>&lt;p&gt;</code> elements</li>
            <li>The lines (<code>&lt;l&gt;</code>) of each poem should be numbered</li>
            <li>Each poem's title (in the body of the HTML) should be wrapped in a
                    <code>&lt;h2&gt;</code> element that has a corresponding <code>@id</code> value
                linked from the table of contents</li>
            <li><strong>The second bonus task</strong> (the styling bonus): wrap
                    <code>&lt;span&gt;</code> elements around the text we have marked as variants,
                ideally by using a <code>@class</code> attribute that holds the same information as
                the <code>@wit</code> attribute on the <code>&lt;rdg&gt;</code> element in our
                source texts. To generate the attribute value on <code>@class</code> to match the
                    <code>@wit</code> value again use attribute value templates. The second part of
                the bonus is to then create a CSS that styles the variants (<em>Hint: there are only
                    ever three different variants in each <code>&lt;app&gt;</code> element so you
                    will only need to set up <code>@class</code> values for the following three
                        <code>@wit</code> values: <code>var0</code>, <code>var1</code>,
                        <code>var2</code></em>).</li>
        </ul>
        <p>You can see our output at <a href="dickinson-output.html"
            >http://newtfire.org/dh/XSLTExercise3_CDV-output</a>.</p>
        
        <h3>Important</h3>
        <ul>
            <li><strong>Before submitting your homework, you must run the transformation at
                    home</strong> to make sure the results are what you expect them to be. There’s a
                guide to running XSLT transformations inside &lt;oXygen/&gt; on Obdurodon at <a
                    href="http://dh.obdurodon.org/oxygen-xslt-configuration.html"
                    title="How to run a transformation in oXygen"
                    >http://dh.obdurodon.org/oxygen-xslt-configuration.html</a>. When running XSLT over a collection it does not matter what XML is selected as the XML source as long as you have defined and called on the collection in your XSLT. If you don’t get
                the results you expect and can’t figure out what you’re doing wrong, remember that
                you can post a query to our <a href="https://github.com/ebeshero/DHClass-Hub/issues"
                    >DHClass-Hub Issues board</a>. You can’t just ask for the answer, though; you
                need to describe what you tried, what you expected, what you got, and what you think
                the problem is. We often find, just as we’re preparing to post our own queries to
                coding discussion boards, that having to write up a description of the problem helps
                us think it through and solve it ourselves. We’re also encouraging you to discuss
                the homework on the discussion boards because that’s also helpful for the person who
                responds. Answering someone else’s inquiry and troubleshooting someone else’s
                problem often helps us clarify matters for ourselves!</li>

            <li>When you complete this assignment, you need to submit your XSLT file and the CSS
                file (if you chose to complete the styling bonus) to Courseweb, following our usual
                homework file-naming conventions. We will run your XSLT transformation to see what
                output it generates, so you do not need to submit your output file. However, it is
                important that if you have completed the styling bonus you include your CSS so we
                can locally associate it to your XSLT (keeping them in the same folder space) and
                see your final output. <strong>You should link the CSS in the XSLT for
                us!</strong></li>
        </ul>
        <!-- UNEDITED ADDITIONS THAT NEED TO BE INCLUDED IN THE ASSIGNMENT --> NEED TO INCLUDE: <a
            href="http://dh.obdurodon.org/xslt-basics-2.xhtml">Obdurodon's tutorial on XSLT advanced
            features</a><!-- use this for xsl:if statement that will choose whether or not there is a line break (</br>) after each line pending if it the last line of the poem or not-->
    </body>
</html>
